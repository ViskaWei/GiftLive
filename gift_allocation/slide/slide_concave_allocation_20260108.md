# 凹收益分配验证：DG3 未通过 — 5min 汇报

> **Experiment**: VIT-20260108-gift_allocation-08  \
> **Author**: Viska Wei  \
> **Date**: 2026-01-08  \
> **Language**: 中文

---

## 凹收益仅 -1.17% 收益变化，未达 10% 阈值 — DG3 关闭

- **目的**：验证凹收益分配（边际递减）是否能显著优于 Greedy？成功标准：收益提升 ≥10% + Gini 改善
- **X 一句话**：$X := \underbrace{\text{Concave Allocation}}_{\text{边际递减分配}}\;\xrightarrow{g'(V_s) \cdot v_{u,s}}\;\underbrace{\text{公平性提升}}_{\text{避免头部堆叠}}$
  - Why: 贪心导致头部主播获得所有流量（马太效应）
  - How: 按边际效用加权分配，收益高的主播边际递减
- **I/O（带符号）**：输入模拟环境，输出凹收益 vs Greedy 对比，核心权衡是「公平性 vs 收益」

| 类型 | 符号 | 说明 | 示例 |
|------|------|------|------|
| 🫐 输入 | $\mathcal{E}$ | 模拟环境 | 10k 用户 × 500 主播 |
| 🫐 输入 | $V_s$ | 主播累计收益 | 用于计算边际效用 |
| 🫐 输出 | $s^*$ | 分配决策 | $\arg\max g'(V_s) \cdot v_{u,s}$ |
| 📊 指标 | $R, G$ | 收益/Gini | -1.17% / -0.018 |
| 🍁 基线 | $\pi_0$ | Greedy | Revenue=254,752 |

<details>
<summary><b>note</b></summary>

今天分享凹收益分配实验。

核心结论是：**凹收益收益变化仅 -1.17%，未达到 10% 阈值，DG3 不通过**。

我们想解决的问题是：Greedy 导致马太效应，头部主播拿走所有流量。理论上，边际递减能让收益分布更公平。

方法是凹函数加权：$s^* = \arg\max g'(V_s) \cdot v_{u,s}$。主播收益越高，边际效用 g'(V) 越小，下一次分配给他的概率就越低。

看 I/O 表：核心输出是分配决策。我们测试了两种凹函数：对数型和饱和型。

</details>

---

## 边际递减分配 + 实验流程 + 关键结果

- **算法**：凹函数加权，边际效用递减

$$s^* = \arg\max_s g'(V_s) \cdot v_{u,s}$$

| 类型 | $g(V)$ | $g'(V)$ | 特点 |
|------|--------|---------|------|
| 对数型 | $\log(1+V)$ | $\frac{1}{1+V}$ | 衰减慢 |
| 饱和型 | $B(1-e^{-V/B})$ | $e^{-V/B}$ | 快速衰减 |

- **流程（5 步）**：
```
实验流程
├── 1. 准备环境
│   └── SimulatorV1: 10k 用户 × 500 主播
├── 2. 构建对比组
│   └── Random / Greedy / Concave-log / Concave-exp / Greedy+Cap
├── 3. 核心循环
│   ├── × 100 次模拟
│   └── × 50 轮: argmax g'(V)*v 分配
├── 4. 参数扫描
│   └── B ∈ [100, 500, 1000, 5000, 10000]
└── 5. 评估
    └── Revenue / Gini / Top-10% Share
```

- **结果**：

| Policy | Revenue | Δ Rev % | Gini | Δ Gini |
|--------|---------|---------|------|--------|
| greedy | 254,752 | 0.00% | 0.529 | 0 |
| concave_log | 233,659 | **-8.28%** | 0.549 | +0.020 |
| **concave_exp** | 251,783 | **-1.17%** | 0.512 | **-0.018** |

<details>
<summary><b>note</b></summary>

算法核心是边际递减：主播收益 V 越高，边际效用 g'(V) 越小。我们测试了对数型和饱和型两种凹函数。

实验流程：5 种策略对比，参数扫描 B 从 100 到 10000。

看结果表——这是关键发现：
- **Concave-exp（饱和型）是最佳凹函数**：收益只损失 1.17%，Gini 改善 0.018
- Concave-log 太激进：收益损失 8.28%，Gini 反而恶化
- **但都没达到 +10% 收益阈值**，所以 DG3 不通过

另一个发现是**规模效应**：用户规模从 1k 增到 50k，凹收益劣势从 +0.65% 恶化到 -13.67%。规模越大，Greedy 优势越明显。

</details>

---

## 凹收益边际不显著 — 决策：简化为 Greedy + 硬约束

- **结论**：「凹收益的理论优势在实践中被稀释——模拟器环境下贪心已接近最优」
  - 机制层：边际递减虽促进公平，但牺牲了整体效率
  - 证据层：Δ Revenue = -1.17%，远未达到 +10% 阈值
- **决策**：❌ **DG3 未通过 → Gate-2 简化为 Greedy + 硬约束**
  - 凹收益收益边际，用硬约束替代更简单
- **权衡**：公平性改善 Gini -0.018，但代价是复杂度增加 + 规模负效应
- **配置建议**：若仍需凹收益，推荐 B=1000（收益-公平性平衡点）
- **下一步**：
  - 🔴 P0: Gate-2 更新：简化为 Greedy + 硬约束
  - 🔴 P0: Hub 更新：关闭 DG3
  - 🟡 P1: MVP-2.2 冷启动/公平约束

<details>
<summary><b>note</b></summary>

金句是：**凹收益的理论优势在实践中被稀释**。

为什么？因为在模拟器环境下，匹配度是收益的主要驱动力。Greedy 选匹配度最高的主播，已经接近最优。凹函数强制分散，反而损失了匹配度带来的收益。

决策很明确：**DG3 未通过，简化为 Greedy + 硬约束**。凹收益的复杂度不值得，用硬约束更简单。

一个重要发现：**规模负效应**。用户规模越大，凹收益的劣势越明显（50k 用户时损失 13.67%）。这意味着在生产环境（百万级用户）下，凹收益可能更差。

下一步：关闭 DG3，转向 MVP-2.2 冷启动约束。

</details>
